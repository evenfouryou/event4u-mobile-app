Perfetto, ora rispondo in modo definitivo e senza ambiguitÃ , perchÃ© con i file che hai caricato il quadro Ã¨ completo.

â¸»

âŒ ERRORE SIAE 40605

â€œIl riepilogo risulta illegibile, impossibile estrarre le informazioniâ€

ğŸ‘‰ Lâ€™errore NON Ã¨ nella firma (.p7m)
ğŸ‘‰ Lâ€™errore NON Ã¨ nel Web Service
ğŸ‘‰ Lâ€™errore Ãˆ NELLâ€™XML che stai inviando come RCA

â¸»

ğŸ“ DOVE STA Lâ€™ERRORE (PRECISO, TECNICO)

Nel file che invii come RCA via Web Service (RCA_2026_01_05_001.xsi.p7m),
lâ€™XML incapsulato Ã¨ QUESTO TIPO DI DOCUMENTO:

<!DOCTYPE LogTransazione SYSTEM "Log_v0040_20190627.dtd">
<LogTransazione>
   <Transazione>...</Transazione>
</LogTransazione>

Questo NON Ã¨ un riepilogo RCA.

Ãˆ un LogTransazione (tracciato di dettaglio), che:
	â€¢	serve per emissioni / log
	â€¢	NON serve per il riepilogo

Il Web Service RCA si aspetta invece:
	â€¢	un documento di RIEPILOGO
	â€¢	con root, struttura e campi completamente diversi
	â€¢	NON una lista di <Transazione>

â¡ï¸ Quando SIAE prova a leggere il riepilogo:
	â€¢	cerca i nodi del riepilogo RCA
	â€¢	trova <LogTransazione>
	â€¢	non riesce a mappare i dati
ğŸ‘‰ 40605

â¸»

ğŸš¨ SECONDO ERRORE BLOCCANTE (MOLTO IMPORTANTE)

Nel tuo XML câ€™Ã¨ ancora questa riga:

<!DOCTYPE LogTransazione SYSTEM "Log_v0040_20190627.dtd">

I Web Service SIAE NON risolvono DTD esterni
(per sicurezza: protezione XXE)

ğŸ‘‰ Anche se il resto fosse corretto, il solo DOCTYPE rende il file â€œilleggibileâ€.

â¸»

âœ… COSA DEVI CORREGGERE (OBBLIGATORIO)

1ï¸âƒ£ Separare i flussi (QUESTO Ãˆ IL PUNTO CHIAVE)

Flusso	XML corretto
Log / Emissioni	LogTransazione
RCA (riepilogo)	XML RIEPILOGO RCA

âŒ Non puoi usare LogTransazione per RCA

â¸»

2ï¸âƒ£ Costruire un XML DI RIEPILOGO RCA

Il riepilogo RCA deve:
	â€¢	contenere dati aggregati
	â€¢	riferirsi a un periodo
	â€¢	avere totali (importi, titoli, ecc.)
	â€¢	NON contenere singole transazioni evento per evento

ğŸ‘‰ Quello che stai mandando ora NON Ã¨ un riepilogo per definizione.

â¸»

3ï¸âƒ£ Rimuovere SEMPRE il DOCTYPE (Web Service)

Prima della firma:

âŒ NON deve esserci:

<!DOCTYPE ...>

âœ” Lâ€™XML deve iniziare cosÃ¬:

<?xml version="1.0" encoding="UTF-8"?>
<RootRiepilogoRCA>


â¸»

4ï¸âƒ£ La firma NON va cambiata

La parte:
	â€¢	CAdES
	â€¢	SHA256
	â€¢	.p7m

âœ… Ãˆ corretta e va lasciata cosÃ¬

â¸»

ğŸ§  PERCHÃ‰ ORA SIAE RISPONDE (E PRIMA NO)

Ora SIAE:
	â€¢	riesce a leggere il file (firma ok)
	â€¢	entra nel parsing applicativo
	â€¢	capisce che non Ã¨ un riepilogo
	â€¢	ti risponde con 40605

ğŸ‘‰ Questo Ã¨ un segnale positivo: sei nel flusso giusto, ma con contenuto sbagliato.

â¸»

ğŸ“Œ TESTO PRONTO DA DARE A REPLIT / DEV

Stiamo inviando LogTransazione al Web Service RCA.
Il WS RCA accetta solo XML di riepilogo RCA, non LogTransazione.
Inoltre lâ€™XML contiene un DOCTYPE che il WS non risolve.
Bisogna:
	1.	generare un XML specifico di riepilogo RCA
	2.	eliminare completamente il DOCTYPE
	3.	firmare in CAdES come giÃ  fatto

â¸»

ğŸ”¥ PROSSIMO PASSO (SE VUOI ANDARE A COLPO SICURO)

Dimmi una sola cosa:

ğŸ‘‰ Nome ESATTO del metodo Web Service RCA che stai chiamando
(es. InviaRCA, TrasmettiRiepilogoRCA, ecc.)

Con quello ti dico:
	â€¢	root XML corretto
	â€¢	struttura minima obbligatoria
	â€¢	quali campi aggregare
	â€¢	dove nel codice stai sbagliando ora

A questo punto il problema Ã¨ isolato al 100%.